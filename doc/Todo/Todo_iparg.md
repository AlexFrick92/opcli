# Read ip arg

## Overview

Если утилита запускается с аргументом ip адреса,
то необходимо распознать это как команду подключения к серверу
с этим айпи адресом, портом по-умолчанию.

Например: opcli 10.10.10.95
Выполнится подключение к opc.tcp://10.10.10.95:4840

Поддерживаем только IPv4

## Step-by-step

1. Добавить функцию isIPv4(string) bool для проверки формата IPv4
2. В main() добавить проверку: если один аргумент и это IPv4 — вызвать handleConnect с endpoint opc.tcp://IP:4840
3. Обновить manual

## Progress

**Шаг 1: Реализация isIPv4**
- Функция isIPv4 реализована с использованием net.ParseIP для валидации IPv4
- Расположение: internal/parser/parser.go:73-76

**Шаг 2: Парсинг IP аргумента**
- Создана функция parser.ParseStartupArgs(args []string) для обработки аргументов командной строки
- Логика: если передан один аргумент и это IPv4, формируется endpoint opc.tcp://IP:4840 и вызывается commands.Connect()
- Расположение: internal/parser/parser.go:57-70
- main.go вызывает parser.ParseStartupArgs(os.Args) для делегирования парсинга

**Шаг 3: Обновление документации**
- Manual обновлен: добавлена секция "Quick connect" с примером (doc/manual/manual.md:5-17)
- README обновлен: добавлены примеры использования и раздел Limitations (readme.md)

**Рефакторинг архитектуры**
В процессе выполнения задачи проведен рефакторинг согласно архитектуре проекта:
- Создан internal/client/client.go - управление OPC UA подключением
- Создан internal/commands/connect.go и disconnect.go - API слой (бизнес-логика)
- Создан internal/parser/parser.go - CLI парсинг и маршрутизация команд
- main.go упрощен до координации компонентов (51 строка)

Разделение ответственности:
- client - низкоуровневая обертка над gopcua
- commands - бизнес-логика, переиспользуемое API
- parser - CLI адаптер к commands API
- main - точка входа и координация

## Summary

Задача выполнена полностью. Реализован быстрый способ подключения через IP адрес (`opcli 10.10.10.95`).

В процессе выполнения проведен архитектурный рефакторинг кодовой базы: код разделен на слои (client, commands, parser) согласно принципу единственной ответственности. Parser стал единой точкой входа для обработки команд (CLI аргументы + интерактивный shell). Commands выделен как переиспользуемый API слой.

Документация обновлена и соответствует текущей реализации.
